<!doctype html>
	<html lang="en">
	  <head>
        <head>
            <!-- Обязательные метатеги -->
            <meta charset="utf-8">
            <meta name="viewport" content="width=device-width, initial-scale=1">
        
            <!-- Bootstrap CSS -->
            <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
        
            <title>Журнал</title>
          </head>
	  </head>
	  <body>
      <div class="bg-info container-fluid" style="height:55px">
        <form method="post">
          <a class="btn btn-success" href="/schedule" role="button" style="float: left; margin-top: 8px;">Расписание</a>
          <a class="btn btn-success" href="/journal/create_lesson" role="button" style="margin-left:35px; margin-top: 8px;">Добавить внеплановое занятие</a>
          <a class="btn btn-success" href="/report" role="button" style="margin-left:35px; margin-top: 8px;">Отчет</a>
          <a class="btn btn-danger" href="/logoutpage" role="button" style="float: right; margin-top: 8px;">Выход</a>
        </form>
      </div>
      {% if error %}
        <div class="alert alert-danger alert-dismissible fade show" role="alert">
            <strong>{{error}}</strong>
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
      {% endif %}
      {% if success %}
        <div class="alert alert-success alert-dismissible fade show" role="alert">
            <strong>{{success}}</strong>
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
      {% endif %}
      {% for year_key, year_value in table.items %}
        <div class="accordion" id="accordionYear{{year_key}}">
          <div class="card">
            <div class="card-header" id="headingOne">
              <h2 class="mb-0">
                <button class="btn btn-link btn-block text-left" type="button" data-toggle="collapse" data-target="#collapseYear{{year_key}}" aria-expanded="true" aria-controls="collapseYear{{year_key}}">
                  {% for year_hours_key, year_hours_value in hours.items %}
                    {% if year_hours_key == year_key %}
                      {{year_key}} год - (Академических часов: {{year_hours_value.count}})
                    {% endif %}
                  {% endfor %}
                </button>
              </h2>
            </div>
            <div id="collapseYear{{year_key}}" class="collapse" aria-labelledby="headingOne" data-parent="#accordionYear{{year_key}}">
              <div class="card-body">
                {% for month_key, month_value in year_value.items %}
                  <div class="accordion" id="accordionMonth{{month_key}}{{year_key}}">
                    <div class="card">
                      <div class="card-header" id="headingOne">
                        <h2 class="mb-0">
                          <button class="btn btn-link btn-block text-left" type="button" data-toggle="collapse" data-target="#collapseMonth{{month_key}}{{year_key}}" aria-expanded="true" aria-controls="collapseMonth{{month_key}}{{year_key}}">
                            {% if month_key == '1' %}
                              {% for year_hours_key, year_hours_value in hours.items %}
                                {% for month_hours_key, month_hourse_value in year_hours_value.items %}
                                  {% if month_hours_key == month_key %}
                                    Январь - (Академических часов: {{month_hourse_value.count}})
                                  {% endif %}
                                {% endfor %}
                              {% endfor %}
                            {% elif month_key == '2' %}
                              {% for year_hours_key, year_hours_value in hours.items %}
                                {% for month_hours_key, month_hourse_value in year_hours_value.items %}
                                  {% if month_hours_key == month_key %}
                                    Февраль - (Академических часов: {{month_hourse_value.count}})
                                  {% endif %}
                                {% endfor %}
                              {% endfor %}
                            {% elif month_key == '3' %}
                              {% for year_hours_key, year_hours_value in hours.items %}
                                {% for month_hours_key, month_hourse_value in year_hours_value.items %}
                                  {% if month_hours_key == month_key %}
                                    Март - (Академических часов: {{month_hourse_value.count}})
                                  {% endif %}
                                {% endfor %}
                              {% endfor %}
                            {% elif month_key == '4' %}
                              {% for year_hours_key, year_hours_value in hours.items %}
                                {% for month_hours_key, month_hourse_value in year_hours_value.items %}
                                  {% if month_hours_key == month_key %}
                                    Апрель - (Академических часов: {{month_hourse_value.count}})
                                  {% endif %}
                                {% endfor %}
                              {% endfor %}
                            {% elif month_key == '5' %}
                              {% for year_hours_key, year_hours_value in hours.items %}
                                {% for month_hours_key, month_hourse_value in year_hours_value.items %}
                                  {% if month_hours_key == month_key %}
                                    Май - (Академических часов: {{month_hourse_value.count}})
                                  {% endif %}
                                {% endfor %}
                              {% endfor %}
                            {% elif month_key == '6' %}
                              {% for year_hours_key, year_hours_value in hours.items %}
                                {% for month_hours_key, month_hourse_value in year_hours_value.items %}
                                  {% if month_hours_key == month_key %}
                                    Июнь - (Академических часов: {{month_hourse_value.count}})
                                  {% endif %}
                                {% endfor %}
                              {% endfor %}
                            {% elif month_key == '7' %}
                              {% for year_hours_key, year_hours_value in hours.items %}
                                {% for month_hours_key, month_hourse_value in year_hours_value.items %}
                                  {% if month_hours_key == month_key %}
                                    Июль - (Академических часов: {{month_hourse_value.count}})
                                  {% endif %}
                                {% endfor %}
                              {% endfor %}
                            {% elif month_key == '8' %}
                              {% for year_hours_key, year_hours_value in hours.items %}
                                {% for month_hours_key, month_hourse_value in year_hours_value.items %}
                                  {% if month_hours_key == month_key %}
                                    Август - (Академических часов: {{month_hourse_value.count}})
                                  {% endif %}
                                {% endfor %}
                              {% endfor %}
                            {% elif month_key == '9' %}
                              {% for year_hours_key, year_hours_value in hours.items %}
                                {% for month_hours_key, month_hourse_value in year_hours_value.items %}
                                  {% if month_hours_key == month_key %}
                                    Сентябрь - (Академических часов: {{month_hourse_value.count}})
                                  {% endif %}
                                {% endfor %}
                              {% endfor %}
                            {% elif month_key == '10' %}
                              {% for year_hours_key, year_hours_value in hours.items %}
                                {% for month_hours_key, month_hourse_value in year_hours_value.items %}
                                  {% if month_hours_key == month_key %}
                                    Октябрь - (Академических часов: {{month_hourse_value.count}})
                                  {% endif %}
                                {% endfor %}
                              {% endfor %} 
                            {% elif month_key == '11' %}
                              {% for year_hours_key, year_hours_value in hours.items %}
                                {% for month_hours_key, month_hourse_value in year_hours_value.items %}
                                  {% if month_hours_key == month_key %}
                                    Ноябрь - (Академических часов: {{month_hourse_value.count}})
                                  {% endif %}
                                {% endfor %}
                              {% endfor %}
                            {% elif month_key == '12' %}
                              {% for year_hours_key, year_hours_value in hours.items %}
                                {% for month_hours_key, month_hourse_value in year_hours_value.items %}
                                  {% if month_hours_key == month_key %}
                                    Декабрь - (Академических часов: {{month_hourse_value.count}})
                                  {% endif %}
                                {% endfor %}
                              {% endfor %}
                            {% endif %}
                          </button>
                        </h2>
                      </div>
                      <div id="collapseMonth{{month_key}}{{year_key}}" class="collapse" aria-labelledby="headingOne" data-parent="#accordionMonth{{month_key}}{{year_key}}">
                        <div class="card-body">
                          {% for day_key, day_value in month_value.items %}
                            <div class="accordion" id="accordionDay{{day_key}}{{month_key}}{{year_key}}">
                              <div class="card">
                                <div class="card-header" id="headingOne{{day_key}}{{month_key}}{{year_key}}">
                                  <h2 class="mb-0">
                                    <button class="btn btn-link btn-block text-left" type="button" data-toggle="collapse" data-target="#collapseDay{{day_key}}{{month_key}}{{year_key}}" aria-expanded="true" aria-controls="collapseDay{{day_key}}{{month_key}}{{year_key}}">
                                      {% if month_key == '12' %}
                                        {% for year_hours_key, year_hours_value in hours.items %}
                                          {% for month_hours_key, month_hours_value in year_hours_value.items %}
                                            {% for day_hours_key, day_hours_value in month_hours_value.items %}
                                              {% if day_hours_key == day_key %}
                                                {{day_key}}.{{month_key}}.{{year_key}} - (Академических часов: {{day_hours_value}})
                                              {% endif %}
                                            {% endfor %}
                                          {% endfor %}
                                        {% endfor %}
                                      {% elif month_key == '11' %}
                                        {% for year_hours_key, year_hours_value in hours.items %}
                                          {% for month_hours_key, month_hours_value in year_hours_value.items %}
                                            {% for day_hours_key, day_hours_value in month_hours_value.items %}
                                              {% if day_hours_key == day_key %}
                                                {{day_key}}.{{month_key}}.{{year_key}} - (Академических часов: {{day_hours_value}})
                                              {% endif %}
                                            {% endfor %}
                                          {% endfor %}
                                        {% endfor %}
                                      {% elif month_key == '10' %}
                                        {% for year_hours_key, year_hours_value in hours.items %}
                                          {% for month_hours_key, month_hours_value in year_hours_value.items %}
                                            {% for day_hours_key, day_hours_value in month_hours_value.items %}
                                              {% if day_hours_key == day_key %}
                                                {{day_key}}.{{month_key}}.{{year_key}} - (Академических часов: {{day_hours_value}})
                                              {% endif %}
                                            {% endfor %}
                                          {% endfor %}
                                        {% endfor %}
                                      {% else %}
                                        {% for year_hours_key, year_hours_value in hours.items %}
                                          {% for month_hours_key, month_hours_value in year_hours_value.items %}
                                            {% for day_hours_key, day_hours_value in month_hours_value.items %}
                                              {% if day_hours_key == day_key %}
                                                {{day_key}}.0{{month_key}}.{{year_key}} - (Академических часов: {{day_hours_value}})
                                              {% endif %}
                                            {% endfor %}
                                          {% endfor %}
                                        {% endfor %}
                                      {% endif %}
                                    </button>
                                  </h2>
                                </div>
                                <div id="collapseDay{{day_key}}{{month_key}}{{year_key}}" class="collapse" aria-labelledby="headingOne" data-parent="#accordionDay{{day_key}}{{month_key}}{{year_key}}">
                                  <div class="card-body">
                                    <table class="table">
                                      <thead>
                                        <tr>
                                          <th scope="col">Время занятия</th>
                                          <th scope="col">Тип занятия</th>
                                          <th scope="col">Группы</th>
                                          <th scope="col">Посещаемость</th>
                                          <th></th>
                                          <th></th>
                                        </tr>
                                      </thead>
                                      <tbody>
                                        {% for lesson in day_value %}
                                          <tr>
                                            <td>{{lesson.time}}</td>
                                            <td>{{lesson.type}}</td>
                                            <td>{{lesson.groups}}</td>
                                            {% if lesson.real_students == None %}
                                              <td>Еще не проведено</td>
                                            {% else %}
                                              <td>{{lesson.real_students}}/{{lesson.all_students}}</td>
                                            {% endif %}
                                            {% if lesson.real_students == None %}
                                              <td><button type="button" class="btn btn-warning" data-bs-toggle="modal" data-bs-target="#editlesson{{lesson.id}}">Отметить проведённым</button></td>
                                              <div class="modal fade" id="editlesson{{lesson.id}}" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                                <div class="modal-dialog">
                                                  <div class="modal-content">
                                                    <div class="modal-header">
                                                      <h5 class="modal-title" id="exampleModalLabel">Отметка о проведении занятия</h5>
                                                      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                                    </div>
                                                    <div class="modal-body">
                                                      <form method="post">
                                                        {% csrf_token %}
                                                        <div class="mb-3">
                                                          <label for="inputstudents" class="form-label">Реальная посещаемость</label>
                                                          <input name="lessonstudents" type="text" class="form-control" id="inputstudents" aria-describedby="studentsform" required>
                                                        </div>
                                                        <input type="hidden" id="{{lesson.id}}" name="lesson_id" value="{{lesson.id}}">
                                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Отмена</button>
                                                        <button type="submit" class="btn btn-warning my-3" name="Post">Подтвердить</button>
                                                      </form>
                                                    </div>
                                                  </div>
                                                </div>
                                              </div>
                                            {% endif %}
                                          </tr>
                                        {% endfor %}
                                      </tbody>
                                    </table>
                                  </div>
                                </div>
                              </div>
                            </div>
                          {% endfor %}
                        </div>
                      </div>
                    </div>
                  </div>
                {% endfor %}
              </div>
            </div>
          </div>
        </div>
      {% endfor %}
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js" integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf" crossorigin="anonymous"></script>
      <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
      <script src="https://stackpath.bootstrapcdn.com/bootstrap/5.0.0-alpha1/js/bootstrap.min.js" integrity="sha384-oesi62hOLfzrys4LxRF63OJCXdXDipiYWBnvTl9Y9/TRlw5xlKIEHpNyvvDShgf/" crossorigin="anonymous"></script>
	  </body>
	</html>